name: Deploy Hugo

# GitHub Actionsのトリガーを好きなように設定する
on:
push:
    branches:
    - main

jobs:
deploy:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
        with:
        submodules: true
        fetch-depth: 0

    - name: Setup Hugo
        uses: peaceiris/actions-hugo@v2
        with:
          hugo-version: "0.92.2"
          extended: true

    - name: Build
        run: hugo --minify

    - name: Push to blog repo
        uses: cpina/github-action-push-to-another-repository@master
        env:
        # 事前準備で登録しておいたトークン名を書く
        API_TOKEN_GITHUB: ${{ secrets.HUGO_DEPLOY_TOKEN }}
        with:
        # Hugoは`public`ディレクトリにビルド生成物を出力するので
        source-directory: "public"
        # blogレポジトリの所有者アカウント名
        destination-github-username: "kurusunagisa"
        # 生成物をPushするレポジトリ名（今回はblog）
        destination-repository-name: "blog"
        # メールアドレス
        user-email: kurusunagisa963@gmail.com